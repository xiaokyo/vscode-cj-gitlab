<div id="app" class="container">
  <!-- é¡¹ç›®ä¿¡æ¯å¤´éƒ¨ -->
  <header class="app-header">
    <div class="project-title">
      <h3>{{state.projectInfo.name}}</h3>
      <div class="branch-badge" @click="copyBranch" title="ç‚¹å‡»å¤åˆ¶åˆ†æ”¯å">{{state.currentBranch}}</div>
    </div>
    <p v-if="state.projectInfo.description" class="project-description">
      {{state.projectInfo.description}}
    </p>
  </header>

  <!-- æœªæäº¤æ–‡ä»¶è­¦å‘Š -->
  <div v-if="state.stashFiles.length > 0" class="notification notification-warning">
    <div class="notification-header">
      <span class="notification-icon">âš ï¸</span>
      <h3>æœªæäº¤æ›´æ”¹</h3>
    </div>
    <div class="notification-content">
      <div class="file-list">
        <div class="file-item" v-for="file in state.stashFiles" :key="file"
          @click="vsPostMsg({ command: 'openFile', content: file })">
          <span class="file-item-icon">ğŸ“„</span>
          <span class="file-item-name">{{ formatFileName(file) }}</span>
          <span class="file-item-action">æŸ¥çœ‹ â†’</span>
        </div>
      </div>
    </div>
  </div>

  <!-- å¿«æ·æ“ä½œåŒº -->
  <div class="quick-actions">
    <button class="quick-action-btn primary" :class="{'loading': loading.test}"
      @click="vsPostMsg({ command: 'publishToTest' })">
      <span class="quick-action-icon">ğŸš€</span>
      <div class="quick-action-content">
        <span class="quick-action-title">å‘å¸ƒæµ‹è¯•ç«™</span>
        <span class="quick-action-desc">éƒ¨ç½²åˆ°æµ‹è¯•ç¯å¢ƒ</span>
      </div>
    </button>

    <button class="quick-action-btn" :class="{'loading': loading.cn}" @click="vsPostMsg({ command: 'publishToCn' })">
      <span class="quick-action-icon">ğŸŒ</span>
      <div class="quick-action-content">
        <span class="quick-action-title">å‘å¸ƒå›½å†…ç«™</span>
        <span class="quick-action-desc">éƒ¨ç½²åˆ°å›½å†…ç”Ÿäº§ç¯å¢ƒ</span>
      </div>
    </button>

    <button class="quick-action-btn" :class="{'loading': loading.prod}"
      @click="vsPostMsg({ command: 'publishToProd' })">
      <span class="quick-action-icon">ğŸŒ</span>
      <div class="quick-action-content">
        <span class="quick-action-title">å‘å¸ƒCOMç«™</span>
        <span class="quick-action-desc">éƒ¨ç½²åˆ°å›½é™…ç”Ÿäº§ç¯å¢ƒ</span>
      </div>
    </button>

    <button class="quick-action-btn" :class="{'loading': loading.prod || loading.cn}"
      @click="vsPostMsg({ command: 'getProdAndCnInfo' })">
      <span class="quick-action-icon">ğŸ“‹</span>
      <div class="quick-action-content">
        <span class="quick-action-title">å¤åˆ¶æ‰€æœ‰</span>
        <span class="quick-action-desc">å¤åˆ¶æ‰€æœ‰åˆå¹¶è¯·æ±‚é“¾æ¥</span>
      </div>
  </div>

  <!-- åˆå¹¶é“¾æ¥é¢æ¿ -->
  <div class="panel" v-if="hasMergeLinks">
    <div class="panel-header">
      <h2>åˆå¹¶è¯·æ±‚</h2>
    </div>
    <div class="panel-content">
      <div class="merge-request-list">
        <div class="merge-request-item" v-for="[env, url] in Object.entries(mergeLinks)" :key="env" v-if="url">
          <div class="merge-request-info">
            <span class="merge-request-env">{{ mergeLinksLabel[env] }}</span>
            <div class="merge-request-actions">
              <a :href="url" class="merge-action-link" target="_blank">
                <span class="merge-action-icon">ğŸ”—</span>
                <span>æŸ¥çœ‹</span>
              </a>
              <button class="merge-action-btn" @click="vsPostMsg({ command: 'copyLink', content: url, env })">
                <span class="merge-action-icon">ğŸ“‹</span>
                <span>å¤åˆ¶</span>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- é¡¹ç›®é“¾æ¥ -->
  <footer class="app-footer" v-if="state.projectInfo.web_url">
    <a :href="state.projectInfo.web_url" class="footer-link" target="_blank">
      <span class="footer-link-icon">ğŸ </span>
      <span>åœ¨ GitLab ä¸­æŸ¥çœ‹é¡¹ç›®</span>
    </a>

    <a :href="state.projectInfo.web_url + '/pipelines'" class="footer-link" target="_blank">
      <span class="footer-link-icon">âš™ï¸</span>
      <span>Pipelines</span>
    </a>

    <!-- tag -->
    <a :href="state.projectInfo.web_url + '/tags'" class="footer-link" target="_blank">
      <span class="footer-link-icon">ğŸ·ï¸</span>
      <span>Tags</span>
    </a>

    <!-- merge_requests -->
    <a :href="state.projectInfo.web_url + '/merge_requests'" class="footer-link" target="_blank">
      <span class="footer-link-icon">ğŸ”„</span>
      <span>Merge Requests</span>
    </a>
  </footer>
</div>