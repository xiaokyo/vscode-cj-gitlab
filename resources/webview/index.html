<div id="app" class="container">
  <!-- é¡¹ç›®ä¿¡æ¯å¤´éƒ¨ -->
  <header class="app-header">
    <div class="project-title">
      <h3>{{state.projectInfo.name}}</h3>
      <div class="branch-badge" @click="copyBranch" title="ç‚¹å‡»å¤åˆ¶åˆ†æ”¯å">{{state.currentBranch}}</div>
    </div>
    <p v-if="state.projectInfo.description" class="project-description">
      {{state.projectInfo.description}}
    </p>
  </header>

  <!-- æœªæäº¤æ–‡ä»¶è­¦å‘Š -->
  <!-- <div v-if="state.stashFiles.length > 0" class="notification notification-warning">
    <div class="notification-header">
      <span class="notification-icon">âš ï¸</span>
      <h3>æœªæäº¤æ›´æ”¹</h3>
    </div>
    <div class="notification-content">
      <div class="file-list">
        <div class="file-item" v-for="file in state.stashFiles" :key="file"
          @click="vsPostMsg({ command: 'openFile', content: file })">
          <span class="file-item-icon">ğŸ“„</span>
          <span class="file-item-name">{{ formatFileName(file) }}</span>
          <span class="file-item-action">æŸ¥çœ‹ â†’</span>
        </div>
      </div>
    </div>
  </div> -->

  <!-- å¿«æ·æ“ä½œåŒº -->
  <div class="quick-actions">
    <button class="quick-action-btn primary" :class="{'loading': loading.test}"
      @click="vsPostMsg({ command: 'publishToTest' })" title="å‘å¸ƒåˆ°æµ‹è¯•ç¯å¢ƒ">
      <span class="quick-action-icon">ğŸš€</span>
      <span class="quick-action-title">TEST</span>
    </button>

    <button class="quick-action-btn" :class="{'loading': loading.cn}" 
      @click="vsPostMsg({ command: 'publishToCn' })" title="å‘å¸ƒåˆ°å›½å†…ç”Ÿäº§ç¯å¢ƒ">
      <span class="quick-action-icon">ğŸŒ</span>
      <span class="quick-action-title">CN</span>
    </button>

    <button class="quick-action-btn" :class="{'loading': loading.prod}"
      @click="vsPostMsg({ command: 'publishToProd' })" title="å‘å¸ƒåˆ°å›½é™…ç”Ÿäº§ç¯å¢ƒ">
      <span class="quick-action-icon">ğŸŒ</span>
      <span class="quick-action-title">COM</span>
    </button>

    <button class="quick-action-btn" :class="{'loading': loading.prod || loading.cn}"
      @click="vsPostMsg({ command: 'getProdAndCnInfo' })" title="å¤åˆ¶æ‰€æœ‰åˆå¹¶è¯·æ±‚é“¾æ¥">
      <span class="quick-action-icon">ğŸ“‹</span>
      <span class="quick-action-title">ALL</span>
    </button>
  </div>

  <!-- åˆå¹¶é“¾æ¥é¢æ¿ -->
  <div class="panel" v-if="hasMergeLinks">
    <div class="panel-header">
      <h2>Merge Requests</h2>
    </div>
    <div class="panel-content">
      <div class="merge-request-list">
        <div class="merge-request-item" v-for="[env, url] in Object.entries(mergeLinks)" :key="env" v-if="url">
          <div class="merge-request-info">
            <span class="merge-request-env">{{ mergeLinksLabel[env] }}</span>
            <div class="merge-request-actions">
              <a :href="url" class="merge-action-link" target="_blank">
                <span class="merge-action-icon">ğŸ”—</span>
                <span>View</span>
              </a>
              <button class="merge-action-btn" @click="vsPostMsg({ command: 'copyLink', content: url, env })">
                <span class="merge-action-icon">ğŸ“‹</span>
                <span>Copy</span>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Tag çŠ¶æ€ -->
  <div class="tag-status" v-if="tagInfo">
    <div class="tag-status-header">
      <span class="tag-status-icon">ğŸ·ï¸</span>
      <span class="tag-status-title">Latest Tag</span>
    </div>
    <div class="tag-status-content">
      <div class="tag-item">
        <span class="tag-name">{{ tagInfo.name }}</span>
        <span class="tag-commit">{{ tagInfo.commit.short_id }}</span>
        <a :href="state.projectInfo.web_url + '/tags/' + tagInfo.name" class="tag-link" target="_blank" title="æŸ¥çœ‹Tagè¯¦æƒ…">
          <span class="tag-link-icon">ğŸ”—</span>
        </a>
      </div>
      <div class="tag-meta" v-if="tagInfo.commit.committed_date">
        <span class="tag-time">{{ formatPipelineTime(tagInfo.commit.committed_date) }}</span>
        <span class="tag-message" v-if="tagInfo.message">{{ tagInfo.message }}</span>
      </div>
    </div>
  </div>

  <!-- Pipeline çŠ¶æ€ -->
  <div class="pipeline-status" v-if="pipelineInfo">
    <div class="pipeline-status-header">
      <span class="pipeline-status-icon">âš™ï¸</span>
      <span class="pipeline-status-title">Pipeline Status</span>
    </div>
    <div class="pipeline-status-content">
      <div class="pipeline-item">
        <span class="pipeline-branch">{{ pipelineInfo.ref }}</span>
        <span class="pipeline-status-badge" :class="'status-' + pipelineInfo.status">
          {{ pipelineInfo.status }}
        </span>
        <a :href="pipelineInfo.web_url" class="pipeline-link" target="_blank" title="æŸ¥çœ‹Pipelineè¯¦æƒ…">
          <span class="pipeline-link-icon">ğŸ”—</span>
        </a>
      </div>
      <div class="pipeline-meta" v-if="pipelineInfo.started_at">
        <span class="pipeline-time">{{ formatPipelineTime(pipelineInfo.started_at) }}</span>
        <span class="pipeline-duration" v-if="pipelineInfo.duration">{{ formatDuration(pipelineInfo.duration) }}</span>
      </div>
    </div>
  </div>

  <!-- é¡¹ç›®é“¾æ¥ -->
  <footer class="app-footer" v-if="state.projectInfo.web_url">
    <a :href="state.projectInfo.web_url" class="footer-link" target="_blank">
      <span class="footer-link-icon">ğŸ </span>
      <span>View Gitlab</span>
    </a>

    <a :href="state.projectInfo.web_url + '/pipelines'" class="footer-link" target="_blank">
      <span class="footer-link-icon">âš™ï¸</span>
      <span>Pipelines</span>
    </a>

    <!-- tag -->
    <a :href="state.projectInfo.web_url + '/tags'" class="footer-link" target="_blank">
      <span class="footer-link-icon">ğŸ·ï¸</span>
      <span>Tags</span>
    </a>

    <!-- merge_requests -->
    <a :href="state.projectInfo.web_url + '/merge_requests'" class="footer-link" target="_blank">
      <span class="footer-link-icon">ğŸ”„</span>
      <span>Merge Requests</span>
    </a>
  </footer>
</div>